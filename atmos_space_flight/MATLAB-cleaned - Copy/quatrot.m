% Copyright Ashish Tewari (c) 2006
function qpp = quatrot(q, qp)
	i = [1, 1, -1, 1; ...
		-1, 1, 1, 1; ...
		1, -1, 1, 1; ...
		-1, -1, -1, 1];
	
	qpp = [qp(4), qp(3), qp(2), qp(1); ...
		qp(3), qp(4), qp(1), qp(2); ...
		qp(2), qp(1), qp(4), qp(3); ...
		qp(1), qp(2), qp(3), qp(4)]';
	
	qpp = (i.*qpp)*q;
	
end
